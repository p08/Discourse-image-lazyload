<script
src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/4.0.2/lazysizes.min.js"
></script>

<script type="text/discourse-plugin" version="0.8.18">

window.lazySizesConfig.expand = 500;

$.fn.dlazy = function() {
  var image = this.find(".lightbox img");
  $.each(image, function() {
    var imageSrc = $(this).attr("src");
      $(this)
        .attr("data-src", imageSrc)
        .addClass("lazyload")
        .attr(
          "src",
          "data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="
        );
  });
};
api.decorateCooked($elem => $elem.dlazy());
</script>
