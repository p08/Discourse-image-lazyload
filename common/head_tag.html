<script
src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/4.0.2/lazysizes.min.js"
></script>
<script 
src="https://cdn.jsdelivr.net/gh/swaydeng/imgcolr@1.0.1/imgcolr.html5.min.js"
></script>

<script type="text/discourse-plugin" version="0.8.18">
const showColor = false;
window.lazySizesConfig.expand = 500;

$.fn.dlazy = function() {
  var image = this.find(".lightbox img");
  $.each(image, function() {
    var imageSrc = $(this).attr("src");

    if (showColor == true) {
      $(this)
        .imgcolr(".lightbox")
        .attr("data-src", imageSrc)
        .addClass("lazyload")
        .attr(
          "src",
          "data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="
        );
    } else {
      $(this)
        .attr("data-src", imageSrc)
        .addClass("lazyload")
        .attr(
          "src",
          "data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="
        );
    }
  });
};
api.decorateCooked($elem => $elem.dlazy());
</script>
